language: nix
env:
  matrix:
    - PYTHON_VERSION=3
    - PYTHON_VERSION=37

script:
  - nix-build --argstr pythonVersion ${PYTHON_VERSION} --arg useSystemNixpks false

jobs:
  include:
    - stage: build
      name: Build source distribution
      script: nix-shell --arg useSystemNixpkgs false --command 'python setup.py sdist'
    - name: Build wheel
      script: nix-shell --arg useSystemNixpkgs false --command 'python setup.py bdist_wheel'
